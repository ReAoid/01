# AIèŠå¤©æœºå™¨äººç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„AIèŠå¤©æœºå™¨äººç³»ç»Ÿï¼Œæ”¯æŒå®æ—¶å¯¹è¯ã€å¤šæ¨¡æ€äº¤äº’ã€è™šæ‹Ÿå½¢è±¡å’Œé•¿æœŸè®°å¿†åŠŸèƒ½ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **æ™ºèƒ½å¯¹è¯**: æ”¯æŒOpenAI GPTã€Ollamaæœ¬åœ°æ¨¡å‹ç­‰å¤šç§AIæä¾›å•†
- **æµå¼å“åº”**: WebSocketå®æ—¶æµå¼è¾“å‡ºï¼Œæ¨¡æ‹ŸçœŸäººæ‰“å­—
- **å¤šè½®å¯¹è¯**: æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†å’Œå¯¹è¯å†å²
- **äººè®¾ç³»ç»Ÿ**: å¤šç§AIè§’è‰²ï¼Œæ”¯æŒä¸ªæ€§åŒ–å®šåˆ¶
- **é•¿æœŸè®°å¿†**: ç”¨æˆ·åå¥½å­¦ä¹ å’Œå¯¹è¯æ€»ç»“
- **æœ¬åœ°éƒ¨ç½²**: æ”¯æŒOllamaæœ¬åœ°AIæ¨¡å‹ï¼Œæ•°æ®å®Œå…¨ç§æœ‰

### å¤šæ¨¡æ€äº¤äº’
- **è¯­éŸ³å¯¹è¯**: è¯­éŸ³è¾“å…¥(ASR)å’Œè¯­éŸ³è¾“å‡º(TTS)
- **å›¾åƒç†è§£**: å›¾ç‰‡ä¸Šä¼ å’ŒOCRè¯†åˆ«
- **æ–‡ä»¶å¤„ç†**: æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼
- **Live2Dè™šæ‹Ÿå½¢è±¡**: äº¤äº’å¼è™šæ‹Ÿè§’è‰²

### æŠ€æœ¯ç‰¹ç‚¹
- **ç°ä»£åŒ–æ¶æ„**: FastAPIåç«¯ + Reactå‰ç«¯
- **å®æ—¶é€šä¿¡**: WebSocketåŒå‘é€šä¿¡
- **å“åº”å¼è®¾è®¡**: é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **PWAæ”¯æŒ**: å¯å®‰è£…çš„Webåº”ç”¨
- **Dockeréƒ¨ç½²**: ä¸€é”®å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Reactå‰ç«¯     â”‚    â”‚  FastAPIåç«¯    â”‚    â”‚   æ•°æ®åº“å±‚      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ èŠå¤©ç•Œé¢      â”‚    â”‚ â€¢ AIæµæ°´çº¿      â”‚    â”‚ â€¢ PostgreSQL    â”‚
â”‚ â€¢ WebSocketå®¢æˆ·ç«¯â”‚â—„â”€â”€â–ºâ”‚ â€¢ ä¸Šä¸‹æ–‡ç®¡ç†    â”‚â—„â”€â”€â–ºâ”‚ â€¢ Redisç¼“å­˜     â”‚
â”‚ â€¢ è¯­éŸ³å¤„ç†      â”‚    â”‚ â€¢ è®°å¿†ç³»ç»Ÿ      â”‚    â”‚ â€¢ å‘é‡æ•°æ®åº“    â”‚
â”‚ â€¢ Live2Dæ¸²æŸ“    â”‚    â”‚ â€¢ æµå¼å¤„ç†      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.11+
- Node.js 18+
- Docker & Docker Compose (æ¨è)
- PostgreSQL 15+
- Redis 7+
- Ollama (å¯é€‰ï¼Œç”¨äºæœ¬åœ°AIæ¨¡å‹)

### æ–¹å¼ä¸€ï¼šDockeréƒ¨ç½² (æ¨è)

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd ai-chatbot-system
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp backend/env.example backend/.env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„APIå¯†é’¥
nano backend/.env
```

3. **å¯åŠ¨æœåŠ¡**
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
```

4. **è®¿é—®åº”ç”¨**
- å‰ç«¯ç•Œé¢: http://localhost:3000
- åç«¯API: http://localhost:8000
- APIæ–‡æ¡£: http://localhost:8000/docs

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘

1. **åç«¯è®¾ç½®**
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create --name 01 python=3.11
activate 01
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–ï¼ˆæ¨èä½¿ç”¨è‡ªåŠ¨å®‰è£…è„šæœ¬ï¼‰
python ../install_dependencies.py
# æˆ–æ‰‹åŠ¨å®‰è£…
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶

# å¯åŠ¨åç«¯æœåŠ¡
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

2. **å‰ç«¯è®¾ç½®**
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

3. **æ•°æ®åº“è®¾ç½®**
```bash
# å¯åŠ¨PostgreSQLå’ŒRedis
docker-compose up -d postgres redis

# æˆ–ä½¿ç”¨æœ¬åœ°å®‰è£…çš„æ•°æ®åº“
```

### æ–¹å¼ä¸‰ï¼šOllamaæœ¬åœ°AIæ¨¡å‹éƒ¨ç½²

å¦‚æœæ‚¨å¸Œæœ›ä½¿ç”¨æœ¬åœ°AIæ¨¡å‹è€Œä¸ä¾èµ–å¤–éƒ¨APIï¼Œå¯ä»¥é…ç½®Ollamaï¼š

1. **å®‰è£…Ollama**
```bash
# macOS/Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Windows: ä» https://ollama.ai/download ä¸‹è½½å®‰è£…åŒ…
```

2. **å¯åŠ¨OllamaæœåŠ¡**
```bash
ollama serve
```

3. **æ‹‰å–æ¨èæ¨¡å‹**
```bash
# ä¸­æ–‡å¯¹è¯æ¨¡å‹
ollama pull qwen:7b

# é€šç”¨æ¨¡å‹
ollama pull llama2:7b

# ä»£ç ç”Ÿæˆæ¨¡å‹
ollama pull codellama:7b
```

4. **é…ç½®ç³»ç»Ÿä½¿ç”¨Ollama**
```bash
# ç¼–è¾‘ .env æ–‡ä»¶
OLLAMA_BASE_URL=http://localhost:11434

# æˆ–ä¿®æ”¹ backend/app/config/config.yaml
ai:
  model:
    provider: "ollama"
    name: "qwen:7b"
```

5. **æµ‹è¯•Ollamaé›†æˆ**
```bash
# ç¯å¢ƒæ£€æŸ¥ï¼ˆæ¨èå…ˆè¿è¡Œï¼‰
python check_environment.py

# å®Œæ•´æµ‹è¯•
python test_ollama.py

# æˆ–ä½¿ç”¨pytest
pytest test_ollama_simple.py -v -s
```

> **é‡åˆ°é—®é¢˜ï¼Ÿ** æŸ¥çœ‹ [æ•…éšœæ’é™¤æŒ‡å—](docs/troubleshooting.md) è·å–è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆã€‚
> 
> **å¸¸è§é—®é¢˜å¿«é€Ÿä¿®å¤**ï¼š
> - ç¼ºå°‘ä¾èµ–ï¼š`python install_dependencies.py`
> - pytestå¼‚æ­¥é”™è¯¯ï¼š`pip install pytest-asyncio` æˆ–ç›´æ¥è¿è¡Œ `python test_ollama.py`
> - Ollamaè¿æ¥å¤±è´¥ï¼šç¡®ä¿è¿è¡Œ `ollama serve`

## ğŸ“ é¡¹ç›®ç»“æ„

```
ai-chatbot-system/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app/                   # ä¸»åº”ç”¨ç¨‹åº
â”‚   â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒåŠŸèƒ½(AIæµæ°´çº¿)
â”‚   â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ api/              # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”‚   â””â”€â”€ Dockerfile           # Dockeré…ç½®
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/                  # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ components/       # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ services/        # APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ store/           # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ package.json         # Node.jsä¾èµ–
â”‚   â””â”€â”€ vite.config.ts      # Viteé…ç½®
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”œâ”€â”€ docker-compose.yml       # Docker Composeé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## âš™ï¸ é…ç½®è¯´æ˜

### åç«¯é…ç½® (`backend/.env`)

```bash
# åŸºç¡€é…ç½®
ENVIRONMENT=development
DEBUG=true
SECRET_KEY=your-secret-key

# AIæœåŠ¡é…ç½®
OPENAI_API_KEY=sk-your-openai-key
ANTHROPIC_API_KEY=your-anthropic-key

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:pass@localhost:5432/chatbot_db
REDIS_URL=redis://localhost:6379/0

# Azureè¯­éŸ³æœåŠ¡
AZURE_SPEECH_KEY=your-azure-speech-key
AZURE_SPEECH_REGION=your-region
```

### å‰ç«¯é…ç½® (`frontend/.env`)

```bash
VITE_API_BASE_URL=http://localhost:8000
VITE_WS_URL=ws://localhost:8000
```

## ğŸ¯ åŠŸèƒ½è¯¦è§£

### 1. AIå¯¹è¯æµæ°´çº¿

ç³»ç»Ÿå®ç°äº†å®Œæ•´çš„AIå¯¹è¯å¤„ç†æµæ°´çº¿ï¼š

1. **è¾“å…¥é¢„å¤„ç†**: æ–‡æœ¬æ¸…ç†ã€æ ‡å‡†åŒ–
2. **æ„å›¾è¯†åˆ«**: ç”¨æˆ·æ„å›¾å’Œæƒ…æ„Ÿåˆ†æ
3. **ä¸Šä¸‹æ–‡ç®¡ç†**: æ™ºèƒ½ä¸Šä¸‹æ–‡è£å‰ªå’Œä¼šè¯æ‘˜è¦
4. **è®°å¿†æ£€ç´¢**: é•¿æœŸè®°å¿†å’Œç”¨æˆ·åå¥½åŒ¹é…
5. **äººè®¾åº”ç”¨**: è§’è‰²ä¸€è‡´æ€§æ£€æŸ¥å’Œè°ƒæ•´
6. **AIç”Ÿæˆ**: æµå¼å“åº”ç”Ÿæˆ
7. **åå¤„ç†**: å†…å®¹è¿‡æ»¤å’Œæ ¼å¼åŒ–
8. **è®°å¿†æ›´æ–°**: æ–°è®°å¿†æå–å’Œå­˜å‚¨

### 2. å¤šè§’è‰²äººè®¾ç³»ç»Ÿ

- **é»˜è®¤åŠ©æ‰‹**: å‹å–„ä¸“ä¸šçš„é€šç”¨åŠ©æ‰‹
- **ä¸“ä¸šé¡¾é—®**: ä¸¥è°¨é«˜æ•ˆçš„å•†åŠ¡é¡¾é—®  
- **æ´»æ³¼åŠ©æ‰‹**: å¯çˆ±çƒ­æƒ…çš„å¹´è½»åŠ©æ‰‹
- **è‡ªå®šä¹‰è§’è‰²**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰äººè®¾

### 3. é•¿æœŸè®°å¿†ç³»ç»Ÿ

- **äº‹å®è®°å¿†**: ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å’Œåå¥½
- **å…³ç³»è®°å¿†**: äººé™…å…³ç³»å’Œç¤¾äº¤ç½‘ç»œ
- **äº‹ä»¶è®°å¿†**: é‡è¦äº‹ä»¶å’Œæ—¶é—´èŠ‚ç‚¹
- **æƒ…æ„Ÿè®°å¿†**: æƒ…æ„ŸçŠ¶æ€å’Œå¿ƒæƒ…å˜åŒ–

### 4. å¤šæ¨¡æ€äº¤äº’

- **è¯­éŸ³è¾“å…¥**: Whisper ASRè¯­éŸ³è¯†åˆ«
- **è¯­éŸ³è¾“å‡º**: Azure TTSæ–‡æœ¬è½¬è¯­éŸ³
- **å›¾åƒå¤„ç†**: OCRæ–‡å­—è¯†åˆ«å’Œå›¾åƒç†è§£
- **æ–‡ä»¶ä¸Šä¼ **: PDFã€Wordç­‰æ–‡æ¡£å¤„ç†

## ğŸ”§ å¼€å‘æŒ‡å—

### APIæ–‡æ¡£

å¯åŠ¨åç«¯æœåŠ¡åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹APIæ–‡æ¡£ï¼š

- **äº¤äº’å¼APIæ–‡æ¡£**: http://localhost:8000/docs
- **ReDocæ–‡æ¡£**: http://localhost:8000/redoc
- **ç³»ç»ŸçŠ¶æ€**: http://localhost:8000/health
- **Ollamaç®¡ç†**: http://localhost:8000/api/ollama/health

#### Ollama APIç¤ºä¾‹

```bash
# æ£€æŸ¥OllamaæœåŠ¡çŠ¶æ€
curl http://localhost:8000/api/ollama/health

# è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨
curl http://localhost:8000/api/ollama/models

# æ‹‰å–æ–°æ¨¡å‹
curl -X POST http://localhost:8000/api/ollama/models/pull \
  -H "Content-Type: application/json" \
  -d '{"model_name": "mistral:7b"}'

# æµ‹è¯•æ¨¡å‹å¯¹è¯
curl -X POST http://localhost:8000/api/ollama/chat \
  -H "Content-Type: application/json" \
  -d '{
    "model": "qwen:7b",
    "messages": [{"role": "user", "content": "ä½ å¥½"}],
    "temperature": 0.7
  }'
```

### WebSocketæ¥å£

```javascript
// è¿æ¥WebSocket
const ws = new WebSocket('ws://localhost:8000/ws/chat/session-id');

// å‘é€æ¶ˆæ¯
ws.send(JSON.stringify({
  type: 'message',
  content: 'ä½ å¥½ï¼'
}));

// æ¥æ”¶æ¶ˆæ¯
ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('æ”¶åˆ°æ¶ˆæ¯:', data);
};
```

### è‡ªå®šä¹‰è§’è‰²

```python
# åœ¨ backend/app/core/character_system.py ä¸­æ·»åŠ æ–°è§’è‰²
new_character = {
    "id": "custom",
    "name": "è‡ªå®šä¹‰è§’è‰²",
    "description": "è§’è‰²æè¿°",
    "personality": {
        "traits": ["ç‰¹å¾1", "ç‰¹å¾2"],
        "formality_level": 0.7
    },
    "writing_style": {
        "tone": "è¯­è°ƒé£æ ¼",
        "use_emoji": True
    }
}
```

## ğŸ§ª æµ‹è¯•

### åç«¯æµ‹è¯•
```bash
cd backend
pytest tests/ -v
```

### å‰ç«¯æµ‹è¯•
```bash
cd frontend
npm run test
```

### é›†æˆæµ‹è¯•
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
npm run test:e2e
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs -f backend

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f
```

### æ€§èƒ½ç›‘æ§

å¯ç”¨ç›‘æ§æœåŠ¡ï¼š
```bash
docker-compose --profile monitoring up -d
```

è®¿é—®ç›‘æ§é¢æ¿ï¼š
- Prometheus: http://localhost:9090
- Grafana: http://localhost:3001 (admin/admin)

## ğŸ”’ å®‰å…¨è€ƒè™‘

- APIå¯†é’¥å®‰å…¨å­˜å‚¨
- è¾“å…¥å†…å®¹è¿‡æ»¤å’ŒéªŒè¯
- é€Ÿç‡é™åˆ¶å’Œé˜²æŠ¤
- HTTPSåŠ å¯†ä¼ è¾“
- ç”¨æˆ·æ•°æ®éšç§ä¿æŠ¤

## ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### 1. æœåŠ¡å™¨è¦æ±‚
- CPU: 4æ ¸å¿ƒä»¥ä¸Š
- å†…å­˜: 8GBä»¥ä¸Š
- å­˜å‚¨: 50GBä»¥ä¸ŠSSD
- ç½‘ç»œ: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

### 2. åŸŸåå’ŒSSLé…ç½®
```bash
# é…ç½®Nginx SSL
cp nginx/ssl.example/* nginx/ssl/
# ç¼–è¾‘ nginx/conf.d/default.conf
```

### 3. ç¯å¢ƒå˜é‡é…ç½®
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®
ENVIRONMENT=production
DEBUG=false
# ä½¿ç”¨å¼ºå¯†é’¥
SECRET_KEY=your-production-secret-key
```

### 4. æ•°æ®åº“ä¼˜åŒ–
```bash
# PostgreSQLä¼˜åŒ–é…ç½®
# ç¼–è¾‘ postgresql.conf
shared_buffers = 256MB
effective_cache_size = 1GB
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒå’Œåé¦ˆ

- ğŸ› [æŠ¥å‘ŠBug](https://github.com/your-repo/issues)
- ğŸ’¡ [åŠŸèƒ½å»ºè®®](https://github.com/your-repo/issues)
- ğŸ“§ é‚®ä»¶æ”¯æŒ: support@example.com
- ğŸ“š [è¯¦ç»†æ–‡æ¡£](./docs/)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [FastAPI](https://fastapi.tiangolo.com/)
- [React](https://reactjs.org/)
- [OpenAI](https://openai.com/)
- [Live2D](https://www.live2d.com/)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼